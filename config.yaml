system:
  version: "Stage 28-30 - Full Cognitive Architecture"

ticks:
  light_tick_sec: 5
  heavy_tick_sec: 60

memory:
  episodic_db: "memory/episodes.db"
  semantic_lance: "memory/semantic.lance"
  max_episodes: 10000

paths:
  state: "memory/state.json"
  snapshots: "memory/snapshots"
  inbox: "inbox.txt"
  outbox: "outbox.txt"

logging:
  level: "INFO"
  dir: "logs"

ollama:
  base_url: "http://127.0.0.1:11434"
  strategy_model: "llama3.2:3b"
  embed_model: "nomic-embed-text"
  timeout_sec: 30
  max_calls_per_tick: 10

scores:
  exploration_base: 0.5
  curiosity_base: 0.5
  caution_base: 0.5
  stability_base: 0.5

  # Thresholds used by ValueEngine.get_mode()
  thresholds:
    stability_warn: 0.4
    accuracy_warn: 0.4
    growth_warn: 0.3

  modes:
    curious:
      exploration_boost: 0.2
      curiosity_boost: 0.2
    cautious:
      caution_boost: 0.2
      stability_boost: 0.2
    defensive:
      caution_boost: 0.3
      stability_boost: 0.3
      exploration_penalty: -0.3
  drift:
    snapshot_dir: "memory/value_snapshots"
    check_interval_ticks: 168
    drift_threshold: 0.3

strategy:
  weekly_update_hours: 24
  max_now_goals: 5
  max_weekly_goals: 3

resources:
  budget:
    tick_timeout_sec: 30

api:
  enabled: true
  host: "127.0.0.1"
  port: 8766

dream:
  enabled: true
  interval_hours: 6
  insights_limit: 5
  max_insights: 50

emotions:
  decay_rate: 0.1
  min_threshold: 0.05

reflection:
  every_n_ticks: 10
  analyze_last_episodes: 15

narrative:
  every_n_ticks: 15

attention:
  enabled: true
  top_k: 5
  min_score: 0.4
  max_context_chars: 1500
  focus_weights:
    urgency: 0.3
    relevance: 0.3
    emotion: 0.2
    novelty: 0.2

curiosity:
  enabled: true
  ask_every_n_ticks: 20
  answer_every_n_ticks: 15
  max_questions: 100

self_modification:
  enabled: true
  suggest_every_n_ticks: 50
  auto_approve_threshold: 0.8
  max_history: 50

beliefs:
  enabled: true
  form_every_n_ticks: 25
  validate_every_n_ticks: 30
  confidence_threshold: 0.5
  max_beliefs: 100

contradictions:
  enabled: true
  detect_every_n_ticks: 40
  resolve_every_n_ticks: 35
  max_contradictions: 50

shell:
  enabled: true
  allowed_dir: "sandbox"
  max_output_chars: 2000
  timeout_sec: 10
  allowed_commands:
    - "ls"
    - "cat"
    - "pwd"
    - "echo"
    - "date"
    - "wc"
    - "head"
    - "tail"
    - "grep"

time_perception:
  enabled: true
  max_patterns: 50
  min_confidence: 0.4
  detect_every_n_ticks: 40

# Stage 23
social:
  enabled: true
  check_inbox_every_tick: true
  initiate_after_ticks: 200

# Stage 24
meta_cognition:
  enabled: true
  analyze_every_ticks: 50
  max_insights: 30
  min_confidence: 0.4

# Stage 26: Skill Library
skills:
  enabled: true
  extract_every_n_ticks: 30
  min_confidence: 0.6
  max_skills: 200

# Stage 27: Multi-Agent Communication (Basic)
multi_agent:
  enabled: true
  agent_name: "primary"
  specialization: "general"
  auto_register: true
  
  network:
    host: "localhost"
    port: 9000
  
  shared_storage:
    registry_path: "memory/multi_agent/registry.json"
    message_storage: "memory/multi_agent/messages"
  
  message_processing:
    poll_interval_sec: 2
    batch_size: 10
  
  delegation:
    enabled: true
    auto_delegate_complex: false
    complexity_threshold: 0.7
  
  consensus:
    enabled: true
    default_timeout_sec: 30
  
  skill_sharing:
    enabled: true
    auto_share_new: false
    min_confidence: 0.7
  
  # ============================================================
  # ðŸš€ NEW: Agent Autoscaling
  # ============================================================
  autoscaling:
    enabled: false  # Set to true to enable automatic scaling
    check_interval_sec: 60  # Check every minute
    
    # Scaling thresholds
    scale_up_threshold: 0.75    # Scale up when avg load > 75%
    scale_down_threshold: 0.25  # Scale down when avg load < 25%
    
    # Cooldown periods (prevent rapid scaling)
    scale_up_cooldown_sec: 300    # 5 min between scale-ups
    scale_down_cooldown_sec: 600  # 10 min between scale-downs
    
    # Agent limits per specialization
    min_agents_per_type: 1
    max_agents_per_type: 5
    
    # Health monitoring
    unhealthy_threshold: 3        # Failed checks before replacement
    heartbeat_timeout_sec: 120    # 2 min without heartbeat = unhealthy
    
    # Resource allocation (ports for new agents)
    port_ranges:
      research: [9101, 9150]
      execution: [9201, 9250]
      analysis: [9301, 9350]
      planning: [9401, 9450]
      testing: [9501, 9550]

# ============================================================
# Stage 28: Advanced Multi-Agent Coordination
# ============================================================
advanced_multi_agent:
  enabled: false  # Disabled by default - requires multi_agent.enabled = true
  
  # AgentRoles - Dynamic role management
  roles:
    enabled: true
    available_roles:
      - "coordinator"    # Orchestrates tasks, makes decisions
      - "specialist"     # Domain expert (research, coding, testing)
      - "worker"         # Executes tasks
    
    # Auto-assign roles based on agent capabilities
    auto_assign: true
    reassign_on_failure: true
  
  # TaskDelegation - Intelligent task routing
  task_delegation:
    enabled: true
    auto_delegate: false  # Auto-delegate tasks from heavy_tick
    
    # Task selection strategy
    selection_strategy: "best_match"  # best_match | round_robin | load_balanced
    
    # Task timeout and retry
    default_timeout_sec: 120
    max_retries: 2
    
    # Task priority levels
    priority_weights:
      high: 1.0
      medium: 0.6
      low: 0.3
  
  # ConsensusBuilder - Democratic decision making
  consensus:
    enabled: true
    
    # Voting parameters
    quorum_percentage: 0.5  # Minimum % of agents that must vote
    approval_threshold: 0.6  # % of votes needed to approve
    
    # Weighted voting based on expertise
    use_weighted_voting: true
    
    # Auto-resolve proposals after timeout
    auto_resolve: true
    proposal_timeout_sec: 60
    
    # Proposal types
    proposal_types:
      - "system_change"     # Modify system configuration
      - "resource_allocation"  # Allocate resources
      - "task_priority"     # Change task priorities
      - "agent_action"      # Agent should take action

# ============================================================
# Stage 29: Long-term Memory Systems
# ============================================================
longterm_memory:
  enabled: true  # Enable long-term memory consolidation
  
  # MemoryConsolidation - Sleep-cycle memory consolidation
  consolidation:
    enabled: true
    interval_hours: 2  # Run consolidation every 2 hours
    
    # Importance scoring
    importance_weights:
      recency: 0.3      # Recent memories more important
      frequency: 0.25   # Frequently accessed
      emotion: 0.25     # Emotional significance
      relevance: 0.2    # Relevance to goals
    
    # Forgetting curve
    forgetting_enabled: true
    min_importance: 0.3  # Forget memories below this threshold
    max_memories: 5000   # Maximum consolidated memories to keep
  
  # SemanticMemory - Concept and fact extraction
  semantic:
    enabled: true
    
    # Concept extraction
    extract_concepts: true
    min_concept_confidence: 0.6
    max_concepts: 1000
    
    # Fact extraction
    extract_facts: true
    max_facts: 2000
    
    # Relationship building
    build_relationships: true
    min_relationship_strength: 0.4
  
  # MemoryRetrieval - Intelligent search
  retrieval:
    enabled: true
    
    # Multi-level search strategy
    search_levels:
      - "episodic"   # Search recent episodes
      - "semantic"   # Search concepts/facts
      - "consolidated"  # Search long-term memories
    
    # Caching
    cache_enabled: true
    cache_size: 100
    cache_ttl_sec: 300
    
    # Result ranking
    ranking_weights:
      relevance: 0.4
      recency: 0.3
      importance: 0.3

# ============================================================
# Stage 30: Self-Evolution Framework
# ============================================================
self_evolution:
  enabled: true  # Enable self-evolution capability
  
  # Evolution modes:
  # - supervised: All changes require human approval
  # - semi_autonomous: Minor changes auto-approved
  # - autonomous: System evolves independently
  mode: "supervised"  # supervised | semi_autonomous | autonomous
  
  # SelfEvolutionManager - Evolution orchestration
  manager:
    # Proposal generation
    suggest_changes_every_ticks: 100
    max_pending_proposals: 10
    
    # Change types allowed
    allowed_change_types:
      - "optimization"      # Performance improvements
      - "bug_fix"          # Fix identified issues
      - "feature_addition" # Add new capabilities
      - "refactoring"      # Code cleanup
    
    # Safety checks
    safety_checks:
      syntax_validation: true
      performance_test: true
      rollback_on_error: true
    
    # Approval workflow (for supervised/semi_autonomous modes)
    approval:
      timeout_hours: 24  # Auto-reject after timeout
      require_justification: true
      min_confidence: 0.7  # Min confidence for semi-autonomous approval
  
  # CodeGenerator - LLM-powered code generation
  code_generator:
    enabled: true
    
    # Generation parameters
    model: "llama3.2:3b"  # Use same as strategy_model
    temperature: 0.7
    max_tokens: 2000
    
    # Code quality
    enforce_style: true
    run_linter: false  # Requires pylint installed
    
    # Optimization hints
    optimize_for:
      - "readability"
      - "performance"
      - "maintainability"
  
  # EvolutionSandbox - Safe testing environment
  sandbox:
    enabled: true
    
    # Isolation
    isolated_execution: true
    sandbox_dir: "sandbox/evolution"
    
    # Testing
    run_tests: true
    test_timeout_sec: 30
    
    # Performance benchmarking
    benchmark_enabled: true
    benchmark_iterations: 10
    
    # Resource limits
    max_cpu_percent: 50
    max_memory_mb: 512
    max_execution_time_sec: 60
  
  # Change history and rollback
  history:
    keep_history: true
    max_history_entries: 100
    backup_before_apply: true
    backup_dir: "memory/self_evolution/backups"

# ============================================================
# Advanced Cognitive Features
# ============================================================

# Layer 4: Original Memory Consolidation
consolidation:
  enabled: true
  interval_hours: 24

# Layer 5: Theory of Mind
user_model:
  enabled: true

# Layer 7: Proactive Behavior
proactive:
  enabled: true

# Layer 8: Meta-Learning
meta_learning:
  enabled: true
